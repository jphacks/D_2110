<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Concept of Symmetry shift #  Background #  The PDB (Protein Data Bank) file contains the coordinates of all atoms in the unit structure, as shown below. The boxed area shows the x-, y-, and z-coordinates of the atoms, from left to right.
It consists mainly of atom, structure, and chain, and the biopython package makes use of this information.
But it only contains data for the unit structure, so it is not possible to get all the structural data at once."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Concept of Symmetry shift #  Background #  The PDB (Protein Data Bank) file contains the coordinates of all atoms in the unit structure, as shown below. The boxed area shows the x-, y-, and z-coordinates of the atoms, from left to right.
It consists mainly of atom, structure, and chain, and the biopython package makes use of this information.
But it only contains data for the unit structure, so it is not possible to get all the structural data at once."><meta property="og:type" content="article"><meta property="og:url" content="https://jphacks.github.io/D_2110/docs/concept/"><meta property="article:section" content="docs"><title>Concept | Symmetry shift</title><link rel=manifest href=/D_2110/manifest.json><link rel=icon href=/D_2110/favicon.png type=image/x-icon><link rel=stylesheet href=/D_2110/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css integrity="sha256-RhgbyTN1upMgJudTs3xA5v+LsWqe93DHi8xmPkV3sbo=" crossorigin=anonymous><script defer src=/D_2110/flexsearch.min.js></script><script defer src=/D_2110/en.search.min.8dfc41ebfc2ccca4552bad38799d8ee266520541f7d0f5da1a29fd405c96c409.js integrity="sha256-jfxB6/wszKRVK604eZ2O4mZSBUH30PXaGin9QFyWxAk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/D_2110/><span>Symmetry shift</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://jphacks.github.io/D_2110/docs/home/>Home</a></li><li><a href=https://jphacks.github.io/D_2110/docs/installation/>Installation</a></li><li><a href=https://jphacks.github.io/D_2110/docs/usage/>Usage</a></li><li><a href=https://jphacks.github.io/D_2110/docs/concept/ class=active>Concept</a></li><li><a href=https://jphacks.github.io/D_2110/docs/examples/>Examples</a></li></ul><ul><li><a href=https://github.com/jphacks/D_2110/ target=_blank rel=noopener>Github</a></li></ul></nav><script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/D_2110/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Concept</strong>
<label for=toc-control><img src=/D_2110/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#workflow>Workflow</a></li></ul></nav></aside></header><article class=markdown><h1 id=concept-of-symmetry-shift>Concept of Symmetry shift
<a class=anchor href=#concept-of-symmetry-shift>#</a></h1><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>The PDB (Protein Data Bank) file contains the coordinates of all atoms in the unit structure, as shown below. The boxed area shows the x-, y-, and z-coordinates of the atoms, from left to right.</p><p><img src=https://user-images.githubusercontent.com/84301337/139531746-ee44b003-c757-45d6-8399-9bde1ea79c4c.jpg alt=pdb_coord></p><p>It consists mainly of atom, structure, and chain, and the biopython package makes use of this information.</p><p>But it only contains data for the unit structure, so it is not possible to get all the structural data at once.</p><p><img src=https://user-images.githubusercontent.com/84301337/140019178-57cb40cc-1d7a-4f43-be5d-f352f842c8d2.jpg alt=pdb_compe_en></p><p>Thus, we decided to perform symmetric operations to the coordinates of the atoms, taking advantage of the fact that the PDB file has the information of the original structure as a comment.</p><p><img src=https://user-images.githubusercontent.com/84301337/139531506-93b5b24b-f1b0-4071-8fee-1d0d63909919.jpg alt=matrix_shift></p><p>This is a set from BIOMT1 to BIOMT3, where the blue boxed area is the rotation matrix and the yellow boxed area is the translation vector.
The green box indicates that the rotation matrix part is a unit matrix and the translation vector part is a zero vector. So, it represents the unit structure itself described in this PDB file.</p><p>By applying this rotation matrix and translation vector to the coordinates in the PDB file, we can obtain the coordinates after symmetry operations.</p><p>In other words, we assume that the original coordinate of an atom is
<link rel=stylesheet href=/D_2110/katex/katex.min.css><script defer src=/D_2110/katex/katex.min.js></script><script defer src=/D_2110/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>\(\vec{r}\)</span>
, the rotation matrix is <span>\(A\)</span>
, and the translation vector is <span>\(\vec{b}\)</span>
. The coordinate after symmetry operations <span>\(\vec{r'}\)</span>
is expressed</p><span>\[\vec{r'}=A\vec{r}+\vec{b}\]</span><p>We perform this operation on each atom, for as many symmetric operations as we need.</p><h2 id=workflow>Workflow
<a class=anchor href=#workflow>#</a></h2><p>This product automates this process of rotation and translation for almost all PDB files.</p><p>Here is a concrete explanation. The following diagram is the workflow of symmetry shift. The red color indicates the part that we developed or added functions. The yellow-green (greenish) parts are the functions that the Bio.</p><p><img src=workflow.drawio.svg alt="Workflow of symmetry shift"></p><p>The user specifies the PDB ID from which he or she wants to retrieve the biological assembly, either in the CLI or as an argument to the Python package. There is no further input from the user. Everything is done within symmetry shift.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>symmetry 5V8K <span style=color:#75715e># PDB ID is 5V8K</span>
</code></pre></div><p>as a package:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> symmetryshift.create_biological_structure_unit <span style=color:#f92672>import</span> create, save

pdb_id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;5V8K&#34;</span>
new_structure <span style=color:#f92672>=</span> create(pdb_id)
save(new_structure)
</code></pre></div><p>symmetry shift gets a PDB file from a free public data server using <code>Bio.PDB</code>(<strong>Recieve PDB ID</strong>)</p><p>The next step is to analyze the header (<strong>Get matrix</strong>) and get the coordinates of all atoms (<strong>Get coordinates of Atoms</strong>). Symmetry shift use <code>PDB.PDBParser</code> and <code>PDB.parse_pdb_header</code>, respectively.</p><p>The PDB file contains a header row, where the rotation matrix and translation vector are described in a fixed format.(See Background for details.)</p><p>Once we get matrix and vector, Symmetry shift work operators:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>new_chain <span style=color:#f92672>=</span> chain <span style=color:#f92672>*</span> operator[<span style=color:#e6db74>&#34;matrix&#34;</span>] <span style=color:#f92672>+</span> operator[<span style=color:#e6db74>&#34;shift&#34;</span>]
</code></pre></div><p>Finnaly, Symmetry shift save new PDB file.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#workflow>Workflow</a></li></ul></nav></div></aside></main></body></html>